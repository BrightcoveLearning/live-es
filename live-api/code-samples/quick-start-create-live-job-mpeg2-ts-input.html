---
title: 'Inicio rápido: Crear un trabajo en vivo para entrada MPEG2-TS'
parent: Code Samples 
grandparent: Live API
---
 <h1>Esta página se ha movido; se le dirigirá a la <a href="https://apis.support.brightcove.com/live-api/code-samples/quick-start-create-live-job-mpeg2-ts-input.html">nueva ubicación</a> en 3 segundos. ¡Actualiza tus marcadores!</h1>
<script type="text/javascript">
var t = setTimeout (function () { window.location.href = 'https://apis.support.brightcove.com/live-api/code-samples/quick-start-create-live-job-mpeg2-ts-input.html'; }, 3000);
</script>
<article class="bcls-article">
  <h1>Inicio rápido: Creación de un trabajo activo para la entrada MPEG2-TS</h1>
  <summary>Este tutorial le guiará a través de la creación de un trabajo en vivo que acepte entradas MPEG2-TS. El trabajo se crea utilizando la API en vivo.</summary>



<section class="bcls-section">
<h2 id="Overview">Descripción general</h2>

<figure class="bcls-figure"><img alt="general-block-diagram" src="/assets/images/live-api/18727/block-diagram-small.png" />Diagrama de bloques</figure>

<p>Este tutorial explica a nivel de API cómo crear un trabajo de transmisión en vivo en <a href="/">Brightcove en directo</a> que acepte entradas MPEG2-TS. La clave para usar la entrada MPEG2-TS es seleccionar un <code translate="No">protocol</code> que admita MPEG2-TS y que su codificador pueda entregar. Los protocolos compatibles con TS admitidos por Live API son:</p>

<ul>
	<li><code translate="No">rtp</code></li>
	<li><code translate="No">rtp-fec</code></li>
	<li><code translate="No">srt</code></li>
</ul>

<p>Uno de estos protocolos debe especificarse explícitamente para utilizar la entrada TS, porque el protocolo de entrada predeterminado es <code translate="No">rtmp</code>.</p>

<p>Para usar códigos de tiempo SMPTE para recortes, puntos de referencia SSAI o etiquetas ID3, deben insertarse en el video H.264 (AVC) en los mensajes SEI Picture Timing.</p>

<p>Recuerde que estos protocolos usan UDP (User Datagram Protocol) en lugar de TCP para la comunicación entre el codificador y Live, por lo que su firewall / enrutador debe configurarse correctamente y permitir salidas UDP a Internet desde la IP del codificador.</p>

<aside class="bcls-aside bcls-aside--information">Tenga en cuenta que si tiene puertos abiertos en una red local, Brightcove asigna puertos dinámicamente para cada trabajo SRT y RTP, que puede variar entre 10000 y 65535.</aside>

<p>Si está utilizando <code translate="No">rtp-fec</code>, la información FEC se envía en un puerto distinto del medio, por lo que, por ejemplo, si utiliza el puerto 2000, también necesitará abrir los puertos 2002 y 2004 (si utiliza FEC 2D).</p>

<p>Este tutorial usará <a translate="No" href="https://general.support.brightcove.com/developer/concepts-set-curl.html">curl</a> para realizar las solicitudes de API, pero puedes hacerlas fácilmente en <a translate="No" href="https://apis.support.brightcove.com/general/use-insomnia-api-requests.html">Insomnia</a>, <a translate="No" href="https://apis.support.brightcove.com/general/use-postman-api-requests.html">Postman</a> u otros clientes REST en su lugar.</p>
</section>

<section class="bcls-section">
<h2 id="create_a_live_job">Crea un trabajo en vivo</h2>

<p>Primero, crearemos un trabajo en vivo. Necesitarás un <code translate="No">API-KEY</code> para la API en vivo. Si no lo hace y está interesado en obtener acceso, comuníquese con su gerente de cuenta.</p>

<ol class="bcls-tasklist-restart">
	<li>
	<p>Copie y pegue lo siguiente <span translate="No">rizo</span> comando en un editor de texto:</p>

	<pre class="line-numbers">
  <code class="language-bash" translate="No">curl -X POST \
    https://api.bcovlive.io/v1/jobs \
    -H 'Content-Type: application/json' \
    -H 'x-api-key: <span class="bcls-input">{{bcov-live-api-key}}</span>' \
    -d '{
      "live_stream": true,
      "region": "<span class="bcls-input">{{closest_aws_region}}</span>",
      "protocol": "<span class="bcls-input">{{your_protocol}}</span>",
      "cidr_whitelist": ["<span class="bcls-input">{{your_encoder_IPrange}}</span>", "<span class="bcls-input">{{your_backup_encoder_IPrange}}</span>"],
      "outputs": [{
          "label": "hls360p",
          "live_stream": true,
          "height": 360,
          "video_bitrate": 365,
          "segment_seconds": 6,
          "keyframe_interval": 60
     },
     {
          "label": "hls432p",
          "live_stream": true,
          "height": 432,
          "video_bitrate": 730,
          "segment_seconds": 6,
          "keyframe_interval": 60
     },
     {
          "label": "hls540p",
          "live_stream": true,
          "height": 540,
          "video_bitrate": 2000,
          "segment_seconds": 6,
          "keyframe_interval": 60
     },
     {
          "label": "hls720p3M",
          "live_stream": true,
          "height": 540,
          "video_bitrate": 2000,
          "segment_seconds": 6,
          "keyframe_interval": 60
     },
     {
          "label": "hls720p4.5M",
          "live_stream": true,
          "height": 720,
          "video_bitrate": 4500,
          "segment_seconds": 6,
          "keyframe_interval": 60
     }]
  }'</code></pre>
	</li>
	<li>
	<p><strong>Realice los siguientes reemplazos:</strong></p>

	<ul>
		<li><code translate="No">{{bcov-live-api-key}}</code> con su clave API en vivo de Brightcove. Por ejemplo: <code translate="No">abcdfeg-this-is-a-fake-api-key-FgJajjasd12hJHsZ</code></li>
		<li><code translate="No">{{closest_aws_region}}</code> con la región disponible más cercana a su codificador, consulte <a href="/live-api/getting-started/overview-brightcove-live-api.html#Support_aws_regions">regiones disponibles más cercanas</a> a su codificador. Por ejemplo: <code translate="No">us-west-2</code></li>
		<li><code translate="No">{{your_protocol}}</code> con el protocolo de entrada que el codificador entregará: <code translate="No">rpt</code>, <code translate="No">rtp-fec</code> , o <code translate="No">srt</code></li>
		<li><code translate="No">{{your_encoder_IPrange}}</code> con el rango de IP que usará su codificador, en forma de <code translate="No">1.2.3.4/32</code></li>
		<li><code translate="No">{{your_backup_encoder_IPrange}}</code>(si hay alguno) con el rango de IP que utilizará su codificador de respaldo, en forma de <code translate="No">1.2.3.4/32</code></li>
	</ul>
	</li>
	<li>Después de realizar esos cambios, copie y pegue el código en Terminal o en cualquier aplicación de línea de comandos que use y ejecútelo.</li>
	<li>
	<p>La respuesta debería ser algo como esto si está utilizando el <code translate="No">rtp-fec</code> protocolo:</p>

	<pre class="line-numbers">
  <code class="language-json" translate="No">{
      "id": "42c913e5373844a99a6285367f2704ec",
      "outputs": [... removed for simplicity ...],
      "stream_url": "<span class="bcls-highlight">rtp:</span>//ec2-34-212-0-224.us-west-2.compute.amazonaws.com:12675",
      "stream_name": "42c913e5373844a99a6285367f2704ec.stream",
      "static": false,
      "encryption": {},
      "playback_url": "https://bcovlive-a.akamaihd.net/42c913e5373844a99a6285367f2704ec/us-west-2/NA/playlist.m3u8",
      "playback_url_dvr": "https://bcovlive-a.akamaihd.net/42c913e5373844a99a6285367f2704ec/us-west-2/NA/playlist_dvr.m3u8"
  }</code></pre>

	<p>O así para <code translate="No">srt</code>:</p>

	<pre class="line-numbers">
  <code class="language-json" translate="No">{
      "id": "cdb820f2d7764b91a79536dac799fb77",
      "outputs": [... removed for simplicity ...],
      "stream_url": "srt://ec2-34-212-0-224.us-west-2.compute.amazonaws.com:13820",
      "stream_name": "cdb820f2d7764b91a79536dac799fb77.stream",
      "static": false,
      "encryption": {},
      "playback_url": "https://bcovlive-a.akamaihd.net/cdb820f2d7764b91a79536dac799fb77/us-west-2/NA/playlist.m3u8",
      "playback_url_dvr": "https://bcovlive-a.akamaihd.net/cdb820f2d7764b91a79536dac799fb77/us-west-2/NA/playlist_dvr.m3u8"
  }</code></pre>
	</li>
</ol>

<aside class="bcls-aside bcls-aside--information">Tenga en cuenta que el puerto (13820 en el ejemplo anterior) para la secuencia SRT es único para cada trabajo, y debe obtenerlo de la respuesta a la solicitud de creación de trabajo.</aside>

<p>Estos trabajos crearán 5 representaciones. <strong>basado</strong> en <a href="https://developer.apple.com/documentation/http_live_streaming/hls_authoring_specification_for_apple_devices">Recomendaciones de Apple</a>.</p>
</section>

<section class="bcls-section">
<h2 id="Configure_your_encoder_ts">Configure su codificador (TS + FEC)</h2>

<p>Los pasos que se muestran aquí supondrán una <a href="https://www.elemental.com/products/aws-elemental-live">Caja viva elemental</a> codificador, que se utilizó para probar los pasos de este tutorial. Si tiene un codificador diferente, la configuración debería ser similar.</p>

<p>Los ajustes más importantes para esto <code translate="No">rtp-fec</code> entrada son:</p>

<ul>
	<li>Configurar la fuente del código de tiempo como "reloj del sistema"</li>
	<li>Establezca "Corrección de errores de reenvío" en "Columna y fila" y establezca los valores de "Profundidad de columna" y "Longitud de fila":
	<ul>
		<li><strong>Profundidad de columna:</strong> 4 (se agregará 1 paquete FEC adicional a cada paquete TS de "profundidad de columna")</li>
		<li><strong>Longitud de la fila:</strong> 10 (se agregará 1 paquete FEC adicional por cada paquete TS de "Longitud de fila")</li>
		<li>Los datos adicionales agregados se pueden calcular: TotalBitrate = MediaBitrate * (1 / (ColumnDepth + 1) + 1 / (RowLength + 1)</li>
	</ul>
	</li>
	<li>Marque "inserción de código de tiempo" dentro del video</li>
	<li>Muy recomendado: Velocidad de fotogramas = seguir la fuente</li>
</ul>

<p>Esta es la configuración que usamos para esta muestra de TS + FEC:</p>

<figure class="bcls-figure"><img alt="elemental-live-job-config" title="Elemental live config" src="/assets/images/live-api/18727/elemental-live-job-config-fec-v1a.png" />
<figcaption class="bcls-caption--image">Configuración elemental en vivo</figcaption>
</figure>
</section>

<section class="bcls-section">
<h2 id="Configure_your_encoder_srt">Configura tu codificador (SRT)</h2>

<p>La configuración que se muestra aquí se basa en un <a href="https://www.haivision.com/products/kb-series/">Haivision KB</a> codificador, que se utilizó para probar los pasos de este tutorial. Si tiene un codificador diferente, la configuración debería ser similar.</p>

<p>Esta es la configuración que usamos para esta muestra de SRT:</p>

<figure class="bcls-figure"><img alt="Haivision-live-job-config" title="Haivision live config" src="/assets/images/live-api/18727/haivision-kb-srt-config.png" />
<figcaption class="bcls-caption--image">Configuración en vivo de Haivision</figcaption>
</figure>
</section>

<section class="bcls-section">
<h2 id="test_playback">Prueba de reproducción</h2>

<p>Puedes usar esto <a href="https://videojs.github.io/videojs-contrib-hls/">Página de demostración de VideoJS HLS</a> para probar la reproducción, simplemente pegue el valor <code translate="No">playback_url</code> devuelto en la respuesta del trabajo de creación:</p>

<figure class="bcls-figure"><img alt="videojs-hls-playback" title="VideoJS HLS playback demo page" src="/assets/images/live-api/18727/videojs-hls-playback-small.png" />
<figcaption class="bcls-caption--image">Página de demostración de reproducción de VideoJS HLS</figcaption>
</figure>
</section>
</article>